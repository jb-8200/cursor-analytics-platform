// Package seed defines the data types for seed.json files generated by DataDesigner.
// These types define developer profiles, repository configurations, and correlation parameters
// used by cursor-sim to generate synthetic Cursor usage data.
package seed

// SeedData is the root structure of a seed.json file.
type SeedData struct {
	Version       string        `json:"version"`
	Developers    []Developer   `json:"developers"`
	Repositories  []Repository  `json:"repositories"`
	TextTemplates TextTemplates `json:"text_templates"`
	Correlations  Correlations  `json:"correlations"`
	PRLifecycle   PRLifecycle   `json:"pr_lifecycle"`
}

// Developer represents a team member profile with organizational structure
// and behavioral parameters for event generation.
type Developer struct {
	UserID           string        `json:"user_id"`
	Email            string        `json:"email"`
	Name             string        `json:"name"`
	Org              string        `json:"org"`
	Division         string        `json:"division"`
	Team             string        `json:"team"`
	Role             string        `json:"role"`
	Region           string        `json:"region"`
	Timezone         string        `json:"timezone"`
	Locale           string        `json:"locale"`
	Seniority        string        `json:"seniority"`
	ActivityLevel    string        `json:"activity_level"`
	AcceptanceRate   float64       `json:"acceptance_rate"`
	PRBehavior       PRBehavior    `json:"pr_behavior"`
	CodingSpeed      CodingSpeed   `json:"coding_speed"`
	PreferredModels  []string      `json:"preferred_models"`
	ChatVsCodeRatio  ChatCodeRatio `json:"chat_vs_code_ratio"`
	WorkingHoursBand WorkingHours  `json:"working_hours_band"`
}

// PRBehavior defines PR creation and review behavior parameters.
type PRBehavior struct {
	PRsPerWeek         float64 `json:"prs_per_week"`
	AvgPRSizeLOC       int     `json:"avg_pr_size_loc"`
	AvgFilesPerPR      int     `json:"avg_files_per_pr"`
	ReviewThoroughness float64 `json:"review_thoroughness"`
	IterationTolerance int     `json:"iteration_tolerance"`
}

// CodingSpeed represents time from first commit to PR open (in hours).
type CodingSpeed struct {
	Mean float64 `json:"mean"`
	Std  float64 `json:"std"`
}

// ChatCodeRatio represents the ratio of chat interactions to code completions.
type ChatCodeRatio struct {
	Chat float64 `json:"chat"`
	Code float64 `json:"code"`
}

// WorkingHours defines active hours range based on region.
type WorkingHours struct {
	Start int `json:"start"`
	End   int `json:"end"`
	Peak  int `json:"peak"`
}

// Repository represents a repository with language and service type metadata.
type Repository struct {
	RepoName            string              `json:"repo_name"`
	PrimaryLanguage     string              `json:"primary_language"`
	ServiceType         string              `json:"service_type"`
	DefaultBranch       string              `json:"default_branch"`
	Teams               []string            `json:"teams"`
	Maturity            Maturity            `json:"maturity"`
	CodeQualityBaseline CodeQualityBaseline `json:"code_quality_baseline"`
	CommonFilePatterns  []string            `json:"common_file_patterns"`
}

// Maturity represents repository age and maturity characteristics.
type Maturity struct {
	AgeDays           int `json:"age_days"`
	TotalCommits      int `json:"total_commits"`
	TotalPRs          int `json:"total_prs"`
	TotalContributors int `json:"total_contributors"`
	SizeBytes         int `json:"size_bytes"`
}

// CodeQualityBaseline represents baseline code quality characteristics.
type CodeQualityBaseline struct {
	AvgFileAgeDays      int     `json:"avg_file_age_days"`
	GreenfieldFileRatio float64 `json:"greenfield_file_ratio"`
	RevertRateBaseline  float64 `json:"revert_rate_baseline"`
	HotfixRateBaseline  float64 `json:"hotfix_rate_baseline"`
}

// TextTemplates contains templates for LLM-generated text fields.
type TextTemplates struct {
	CommitMessages   CommitMessageTemplates `json:"commit_messages"`
	PRTitles         []string               `json:"pr_titles"`
	PRDescriptions   []string               `json:"pr_descriptions"`
	ReviewComments   ReviewCommentTemplates `json:"review_comments"`
	ChatPromptThemes ChatPromptThemes       `json:"chat_prompt_themes"`
}

// CommitMessageTemplates contains commit message templates by category.
type CommitMessageTemplates struct {
	Feature  []string `json:"feature"`
	Bugfix   []string `json:"bugfix"`
	Refactor []string `json:"refactor"`
	Chore    []string `json:"chore"`
}

// ReviewCommentTemplates contains review comment templates by category.
type ReviewCommentTemplates struct {
	Style      []string `json:"style"`
	Logic      []string `json:"logic"`
	Suggestion []string `json:"suggestion"`
	Approval   []string `json:"approval"`
}

// ChatPromptThemes contains themes for chat interactions.
type ChatPromptThemes struct {
	CodeGeneration []string `json:"code_generation"`
	Debugging      []string `json:"debugging"`
	Refactoring    []string `json:"refactoring"`
	Explanation    []string `json:"explanation"`
	Learning       []string `json:"learning"`
}

// Correlations contains pre-computed correlation parameters for cursor-sim.
type Correlations struct {
	SeniorityToBehavior map[string]SeniorityBehavior `json:"seniority_to_behavior"`
	RegionToActivity    map[string]RegionActivity    `json:"region_to_activity"`
	LinesPerChange      map[string]LineChangeParams  `json:"lines_per_change"`
	AIRatioBands        AIRatioBands                 `json:"ai_ratio_bands"`
}

// SeniorityBehavior defines behavioral parameters by seniority level.
type SeniorityBehavior struct {
	EventsPerDay       StatParams `json:"events_per_day"`
	TabToComposerRatio float64    `json:"tab_to_composer_ratio"`
	AcceptsPerSession  StatParams `json:"accepts_per_session"`
}

// StatParams represents mean and standard deviation for a distribution.
type StatParams struct {
	Mean float64 `json:"mean"`
	Std  float64 `json:"std"`
}

// StatParamsMax extends StatParams with a maximum value.
type StatParamsMax struct {
	Mean float64 `json:"mean"`
	Std  float64 `json:"std"`
	Max  float64 `json:"max"`
}

// RegionActivity defines activity patterns by region.
type RegionActivity struct {
	WeekdayWeight float64 `json:"weekday_weight"`
	WeekendWeight float64 `json:"weekend_weight"`
	PeakHours     []int   `json:"peak_hours"`
}

// LineChangeParams defines line change parameters by change type.
type LineChangeParams struct {
	Added   StatParamsMax `json:"added"`
	Deleted StatParamsMax `json:"deleted"`
}

// AIRatioBands defines AI ratio classification thresholds.
type AIRatioBands struct {
	Low    AIRatioBand `json:"low"`
	Medium AIRatioBand `json:"medium"`
	High   AIRatioBand `json:"high"`
}

// AIRatioBand defines min/max thresholds for an AI ratio band.
type AIRatioBand struct {
	Min float64 `json:"min,omitempty"`
	Max float64 `json:"max,omitempty"`
}

// PRLifecycle contains correlations for PR lifecycle simulation.
type PRLifecycle struct {
	CycleTimes      CycleTimes        `json:"cycle_times"`
	ReviewPatterns  ReviewPatterns    `json:"review_patterns"`
	QualityOutcomes QualityOutcomes   `json:"quality_outcomes"`
	ScopeCreep      ScopeCreepParams  `json:"scope_creep"`
	ReworkRatio     ReworkRatioParams `json:"rework_ratio"`
}

// CycleTimes contains time distributions for PR lifecycle phases.
type CycleTimes struct {
	CodingLeadTime TimeDistribution `json:"coding_lead_time"`
	PickupTime     TimeDistribution `json:"pickup_time"`
	ReviewLeadTime TimeDistribution `json:"review_lead_time"`
}

// TimeDistribution represents a time distribution with modifiers.
type TimeDistribution struct {
	BaseDistribution string        `json:"base_distribution"`
	Params           StatParams    `json:"params"`
	Modifiers        TimeModifiers `json:"modifiers"`
}

// TimeModifiers contains modifiers for time distributions.
type TimeModifiers struct {
	BySeniority  map[string]float64 `json:"by_seniority,omitempty"`
	ByPRSize     map[string]float64 `json:"by_pr_size,omitempty"`
	ByDayOfWeek  map[string]float64 `json:"by_day_of_week,omitempty"`
	ByTimeOfDay  map[string]float64 `json:"by_time_of_day,omitempty"`
	ByIterations map[string]float64 `json:"by_iterations,omitempty"`
	ByAIRatio    map[string]float64 `json:"by_ai_ratio,omitempty"`
}

// ReviewPatterns contains review behavior parameters.
type ReviewPatterns struct {
	CommentsPer100LOC CommentDensity      `json:"comments_per_100_loc"`
	Iterations        IterationParams     `json:"iterations"`
	ReviewerCount     ReviewerCountParams `json:"reviewer_count"`
}

// CommentDensity defines review comment density parameters.
type CommentDensity struct {
	Base      float64          `json:"base"`
	Modifiers CommentModifiers `json:"modifiers"`
}

// CommentModifiers contains modifiers for comment density.
type CommentModifiers struct {
	ByReviewerSeniority map[string]float64 `json:"by_reviewer_seniority,omitempty"`
	ByAIRatio           map[string]float64 `json:"by_ai_ratio,omitempty"`
}

// IterationParams defines review iteration parameters.
type IterationParams struct {
	BaseDistribution string             `json:"base_distribution"`
	Params           map[string]float64 `json:"params"`
	Modifiers        TimeModifiers      `json:"modifiers,omitempty"`
}

// ReviewerCountParams defines reviewer count parameters.
type ReviewerCountParams struct {
	Base      float64       `json:"base"`
	Modifiers TimeModifiers `json:"modifiers,omitempty"`
}

// QualityOutcomes contains quality outcome parameters.
type QualityOutcomes struct {
	RevertProbability OutcomeParams `json:"revert_probability"`
	HotfixProbability OutcomeParams `json:"hotfix_probability"`
	CodeSurvival30D   OutcomeParams `json:"code_survival_30d"`
}

// OutcomeParams defines outcome probability parameters.
type OutcomeParams struct {
	Base      float64          `json:"base"`
	Modifiers OutcomeModifiers `json:"modifiers,omitempty"`
}

// OutcomeModifiers contains modifiers for outcome probabilities.
type OutcomeModifiers struct {
	ByAuthorSeniority  map[string]float64 `json:"by_author_seniority,omitempty"`
	ByAIRatio          map[string]float64 `json:"by_ai_ratio,omitempty"`
	ByReviewIterations map[string]float64 `json:"by_review_iterations,omitempty"`
}

// ScopeCreepParams defines scope creep parameters.
type ScopeCreepParams struct {
	BaseRatio float64       `json:"base_ratio"`
	Modifiers TimeModifiers `json:"modifiers,omitempty"`
}

// ReworkRatioParams defines rework ratio parameters.
type ReworkRatioParams struct {
	BaseRatio float64       `json:"base_ratio"`
	Modifiers TimeModifiers `json:"modifiers,omitempty"`
}
